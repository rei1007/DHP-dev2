<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>運営ダッシュボード | 大学杯</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="icon" href="assets/favicon.ico">

    <!-- Flatpickr (Date Picker) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/airbnb.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/ja.js"></script>

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        .u-hidden {
            display: none !important;
        }
    </style>
</head>

<body class="admin-layout">
    <!-- Sidebar -->
    <aside class="sidebar">
        <nav class="sidebar-nav">
            <a href="#" class="sidebar-link active" data-tab="tournaments">大会管理</a>
            <a href="#" class="sidebar-link" data-tab="news">お知らせ管理</a>
            <a href="#" class="sidebar-link" data-tab="accounts">アカウント管理</a>
            <hr style="border:0; border-top:1px solid rgba(255,255,255,0.1); margin:10px 0;">
            <a href="#" class="sidebar-link" onclick="handleLogout()">ログアウト</a>
        </nav>
        <div style="margin-top:auto; font-size:0.8rem; opacity:0.6; padding-top:20px;">
            dev.1.1
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="dashboard-header">
            <h2 id="pageTitle" style="font-size:1.5rem; font-weight:700; color:var(--c-primary-dark);">大会管理</h2>
            <div class="user-info">
                <span class="badge info" style="margin-right:10px;" id="userRoleBadge">Admin</span>
                <div class="user-avatar"></div>
                <div class="user-name" id="userNameDisplay">管理者</div>
            </div>
        </header>

        <!-- Content Area -->
        <div id="contentArea">
            <div class="admin-card">
                <div class="card-header">Loading...</div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <!-- Tournament Edit Modal -->
    <div id="tourModal" class="modal u-hidden"
        style="position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:2000; display:flex; align-items:center; justify-content:center;">
        <div class="admin-card"
            style="width:90%; max-width:800px; max-height:90vh; overflow-y:auto; position:relative;">
            <button id="closeTourModal" class="modal-close-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <div class="card-header">
                <span id="tourModalTitle">大会編集</span>
            </div>
            <div id="tourFormContainer"></div>
        </div>
    </div>

    <!-- News Edit Modal -->
    <div id="newsModal" class="modal u-hidden"
        style="position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:2000; display:flex; align-items:center; justify-content:center;">
        <div class="admin-card"
            style="width:90%; max-width:600px; max-height:90vh; overflow-y:auto; position:relative;">
            <button id="closeNewsModal" class="modal-close-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <div class="card-header">
                <span id="newsModalTitle">お知らせ編集</span>
            </div>
            <div id="newsFormContainer"></div>
        </div>
    </div>

    <!-- Caster Edit Modal -->
    <div id="casterModal" class="modal u-hidden"
        style="position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:2000; display:flex; align-items:center; justify-content:center;">
        <div class="admin-card"
            style="width:90%; max-width:800px; max-height:90vh; overflow-y:auto; position:relative;">
            <button id="closeCasterModal" class="modal-close-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <div class="card-header">
                <span id="casterModalTitle">実況解説者情報編集</span>
            </div>
            <div id="casterFormContainer"></div>
        </div>
    </div>

    <!-- Admin User Edit Modal -->
    <div id="adminUserModal" class="modal u-hidden"
        style="position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:2000; display:flex; align-items:center; justify-content:center;">
        <div class="admin-card"
            style="width:90%; max-width:500px; max-height:90vh; overflow-y:auto; position:relative;">
            <button id="closeAdminUserModal" class="modal-close-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <div class="card-header">
                <span id="adminUserModalTitle">運営アカウント編集</span>
            </div>
            <div id="adminUserFormContainer"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/admin.js"></script>
</body>

</html>